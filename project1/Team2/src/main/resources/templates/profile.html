<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Title</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q"
            crossorigin="anonymous"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
    <link rel="stylesheet" href="/css/header.css">
    <!--    <link rel="stylesheet" href="/css/user.css">-->
    <style>
        body {
            background-color: #E5E5F7;
            color: white;
        }

        a {
            text-decoration: none !important;
        }

        main > div.mt-5 {
            font-size: 1.8rem;
            font-weight: 700;
            color: #F4D35E;
            margin-bottom: 1rem;
            padding: 10px 20px;
            background-color: #102B70;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            width: fit-content;
        }

        .container {
            max-width: 650px;
            margin: 40px auto;
            text-align: left;
            padding: 20px;
            /*transform: translateX(-25px);*/
        }

        .form-check {
            position: relative;
            padding-left: 30px; /* ì²´í¬ë°•ìŠ¤ ê³µê°„ í™•ë³´ */
            cursor: pointer;
            user-select: none;
            color: #102b70;
        }

        /* ë°•ìŠ¤ ê¸°ë³¸ ëª¨ì–‘ */
        .form-check-label::before {
            content: "";
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 18px;
            height: 18px;
            border: 2px solid #102b70;
            border-radius: 4px;
            background-color: white; /* ê¸°ë³¸ í°ìƒ‰ */
            box-sizing: border-box;
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        /* ì²´í¬ëì„ ë•Œ ë°°ê²½ìƒ‰ ì±„ìš°ê¸° */
        .genre-checkbox:checked + .form-check-label::before {
            background-color: #102b70; /* ì›í•˜ëŠ” ì±„ìš°ê¸° ìƒ‰ (ì§„í•œ íŒŒë‘ ì˜ˆì‹œ) */
            border-color: #102b70;
        }

        .genre-checkbox {
            position: absolute; /* í™”ë©´ ë°–ìœ¼ë¡œ ìˆ¨ê¸°ê±°ë‚˜ íˆ¬ëª… ì²˜ë¦¬ */
            opacity: 0;
            width: 0;
            height: 0;
            margin: 0;
            padding: 0;
        }

        .preference-special-box {
            border-radius: 5px; /* ëª¨ì„œë¦¬ ë‘¥ê¸€ê²Œ */
            padding: 10px 15px; /* ì•ˆìª½ ì—¬ë°± */
            background-color: white; /* ë°°ê²½ í°ìƒ‰ */
            font-size: 14px;
            color: #102b70;
            box-shadow: 0 4px 8px rgba(16, 43, 112, 0.1);
        }

        .profile-photo-container {
            display: flex;
            justify-content: flex-start;
            align-items: flex-start;
            padding-left: 20px;
            margin-bottom: 0;
        }

        .profile-photo-container img {
            width: 500px;
            height: 210px;
            object-fit: cover;
            border-radius: 0.375rem;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
        }

        input {
            border: 1px solid #CBD5E0;
            background: #E5E5F7;
            font-weight: bold;
            font-size: 15px;
        }

        #selectedGenresBox {
            min-height: 50px;
            white-space: pre-wrap;
            font-weight: 500;
            color: #333;
            background: white;
            padding: 10px;
            border-radius: 6px;
            border: 1px solid #ccc;
        }

        .genre-grid {
            display: flex;
            gap: 20px;
            justify-content: space-between;
            flex-wrap: wrap;
        }

        .genre-column {
            width: 48%;
            border-right: 1px solid #ccc;
            padding-right: 10px;
            color: #0d6efd;
        }

        .genre-column:last-child {
            border-right: none;
            padding-right: 0;
        }

        .form-check {
            min-width: 100px;
        }

        .preference-genre-wrapper {
            background-color: white;
            border-radius: 16px;
            box-shadow: 0 4px 8px rgba(16, 43, 112, 0.1);
            color: #102b70;

            max-width: 100%;
            margin: 20px 0;
            padding: 20px;
        }

        .preference-genre-wrapper label {
            color: #102b70;
        }

        /* ì˜í™” ì¥ë¥´ ì˜ì—­ ì ‘ê³  í¼ì¹˜ê¸° ìŠ¤íƒ€ì¼ */
        .genre-container {
            overflow: hidden;
            transition: max-height 0.3s ease;
            max-height: 125px; /* ê¸°ë³¸ ë†’ì´ - 6ê°œ ì •ë„ */
        }

        .genre-container.expanded {
            max-height: 1000px; /* í¼ì¹  ë•Œ */
        }

        /* í”„ë¡œí•„ ì…ë ¥ í•„ë“œ ë°°ê²½ìƒ‰ ì „í™˜ */
        input[readonly] {
            background-color: #e5e5f7 !important;
            color: #333 !important;
        }

        input:not([readonly]) {
            background-color: white !important;
            color: #000 !important;
        }


        /* ìŠ¤ì™€ì´í¼ ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        .swiper.mySwiper1 {
            width: 100%;
            height: 345px;
            margin-bottom: 3rem;
        }

        .mySwiper1 .swiper-slide {
            text-align: center;
            font-size: 11px;
            color: white;
            font-weight: 600;
        }

        .swiper-slide {
            overflow: hidden;
            padding: 10px;
            transition: box-shadow 0.3s ease;
            text-align: center;
            width: 200px;
        }

        /* ì´ë¯¸ì§€ í™•ëŒ€ íš¨ê³¼ */
        .swiper-slide img {
            width: 100%;
            height: 250px;
            object-fit: cover;
            display: block;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s ease;
            border-radius: 6px;
        }

        /* hover ì‹œ ì´ë¯¸ì§€ ì»¤ì§ */
        img:hover {
            transform: scale(1.05);
        }

        .swiper .swiper-slide img {
            width: 100%;
            height: 250px;
            object-fit: cover;
            display: block;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3); /* x, y, blur, color */
        }

        .mySwiper1 .swiper-slide img {
            width: 100%;
            height: 275px;
            object-fit: cover;
            display: block;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3); /* x, y, blur, color */
        }

        .mySwiper1 .swiper-scrollbar {
            background: #244182;
            border-radius: 10px;
            height: 3px;
        }

        .mySwiper1 .swiper-scrollbar-drag {
            background: #F4D35E;
            border-radius: 10px;
        }

        .my-movie-title {
            font-size: 1rem; /* í¬ê¸° â†‘ */
            font-weight: 700; /* êµµê¸° â†‘ */
            color: #000; /* ê²€ì€ìƒ‰ */
            text-align: left;
        }

        .my-movie-date {
            display: flex;
            color: #000; /* ê²€ì€ìƒ‰ */
            text-align: left;
            font-size: 12px;
        }

        .limit-text {
            white-space: nowrap; /* í•œ ì¤„ë¡œ ìœ ì§€ */
            overflow: hidden; /* ë„˜ì¹˜ëŠ” í…ìŠ¤íŠ¸ ìˆ¨ê¹€ */
            text-overflow: ellipsis; /* ë„˜ì¹˜ë©´ ... í‘œì‹œ */
            max-width: 200px; /* ìµœëŒ€ ë„ˆë¹„ ì§€ì • (ì›í•˜ëŠ” ê°’ìœ¼ë¡œ ì¡°ì ˆ) */
        }

        #fileInput,
        #imageUpload {
            display: none;
        }

        /* ì„¹ì…˜ ì œëª© ìŠ¤íƒ€ì¼ */
        .bookmark {
            font-size: 25px;
            font-weight: 700;
            color: #F4D35E; /* ë¨¸ìŠ¤íƒ€ë“œ ì˜ë¡œìš° */
            padding: 5px 10px;
            background-color: #102B70; /* ì§„í•œ íŒŒë‘ ê³„ì—´ ë°°ê²½ */
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            width: fit-content;
        }

        .preference-wow-box {
            height: 425px;
            border-radius: 5px; /* ëª¨ì„œë¦¬ ë‘¥ê¸€ê²Œ */
            padding: 10px 15px; /* ì•ˆìª½ ì—¬ë°± */
            background-color: white; /* ë°°ê²½ í°ìƒ‰ */
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.05);
        }

        #userfile {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #changeImgbtn {
            padding: 10px 20px;
            background-color: gray;
            color: white;
            border: none;
            cursor: pointer;
        }

        .delform {
            display: flex;
            justify-content: space-between;
            text-align: center;
            margin-top: 4px;
        }

        .delete-button {
            margin: 0;
            border-radius: 3px;
            font-weight: bold;
            color: #F4D35E;
            border: none;
            margin-left: 10px;
            background: #102B70;
        }

        .delete-button:hover {
            transform: scale(1.05);
        }

        #imageUpload {
            display: none;
        }

        #fileInput {
            display: none;
        }

        #toggleMovieGenresBtn {
            color: #102B70;
        }

        #toggleTvGenresBtn {
            color: #102B70;
        }

        #cardform {
            background-color: white;
        }

        #selform {
            height: 377px;
            padding-top: 10px;
        }

    </style>
    <style>
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(231, 231, 249, 0.4); /* ì—°ë³´ë¼ íŒŒìŠ¤í…” */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            backdrop-filter: blur(6px); /* ì‚´ì§ ë” íë¦¼ ì²˜ë¦¬ */
            animation: modalPop 0.4s ease-out; /* ë“±ì¥ ì• ë‹ˆë©”ì´ì…˜ */
        }

        @keyframes modalPop {
            0% {
                transform: scale(0.95);
                opacity: 0;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .modal-content {
            background: white;
            box-shadow: 0 12px 24px rgba(159, 143, 255, 0.2); /* ì—°ë³´ë¼ ê·¸ë¦¼ì */
            padding: 30px 20px;
            border-radius: 12px;
            text-align: center;
            max-height: 80vh;
            width: 360px; /* í¬ê¸° ì¡°ì • */
            overflow-y: auto;
        }

        .image-list {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .image-list img {
            width: 70px;
            height: 70px;
            margin: 5px;
            cursor: pointer;
            border: 2px solid transparent;
            border-radius: 50%;
            transition: border-color 0.3s;
        }

        #selectDoneBtn {
            background-color: #b89eff; /* ë¶€ë“œëŸ¬ìš´ ë¼ë²¤ë” */
            color: white;
            border: none;
            border-radius: 16px;
            padding: 12px 24px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 6px 15px rgba(184, 158, 255, 0.4); /* ì—°ë³´ë¼ ê·¸ë¦¼ì */
            transition: background-color 0.3s ease;
        }

        #selectDoneBtn:hover {
            background-color: #a388ff; /* hover ì‹œ ë” ì§„í•œ ë³´ë¼ */
            transform: scale(1.03); /* ì‘ê²Œ í™•ëŒ€ */
        }

        .modal-content, .image-list, #selectDoneBtn {
            font-family: 'Quicksand', 'Segoe UI', Tahoma, sans-serif;
        }


        .image-list img.selected {
            border-color: #9f8fff; /* ì—°ë³´ë¼ í¬ì¸íŠ¸ */
            box-shadow: 0 0 12px rgba(159, 143, 255, 0.5), 0 0 0 4px rgba(201, 191, 255, 0.3);
            transform: scale(1.1) rotate(-1deg);
        }

        .modal-content h5 {
            color: #7a5fff; /* ì—°ë³´ë¼-ë³´ë¼ ê³„ì—´ í…ìŠ¤íŠ¸ ìƒ‰ */
            font-weight: 700;
            margin-bottom: 20px;
        }

        /* ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë ¸ì„ ë•Œ íš¨ê³¼ */
        .image-list img:hover {
            border-color: #bbaaff;
            transform: scale(1.05) rotate(-2deg);
            box-shadow: 0 4px 10px rgba(187, 170, 255, 0.4);
        }
    </style>
    <style>
        .main-star-rating,
        .star-rating {
            display: flex;
            direction: ltr;
            unicode-bidi: bidi-override;
            background: none;
            user-select: none;
            vertical-align: middle;
            pointer-events: none;
        }

        .main-star-rating {
            margin-left: 60px;
        }

        .star-rating {
        }

        .star {
            display: inline-block;
            position: relative;
            color: #ccc; /* íšŒìƒ‰ ë³„ */
            cursor: pointer;
        }

        .star.full::before,
        .star.half::before {
            content: 'â˜…';
            position: absolute;
            left: 0;
            top: 0;
        }

        .star.full::before {
            color: orange; /* ê°€ë“ì°¬ ë³„ */
        }

        .star.half::before {
            background: linear-gradient(to right, orange 50%, #ccc 50%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .rating-info {
            font-size: 24px;
            vertical-align: middle;
            margin-left: 15px;
            color: #444;
            user-select: none;
        }

    </style>
</head>
<body>
<header th:replace="~{/layout/header :: headerNavbar}"></header>

<main class="container py-4">
    <div class="card shadow-lg border-0 rounded-4 px-4 py-5" id="cardform">
        <div class="row align-items-center g-5">
            <div class="col-md-4 text-center mb-4 mb-md-0 profile-photo-container d-flex flex-column align-items-center"
                 id="userfile">
                <img id="fileImg" th:src="${user.profileImg}"
                     alt="í”„ë¡œí•„ ì‚¬ì§„" class="img-fluid rounded-3 shadow">
                <input type="file" id="fileInput" accept="image/*">
                <button class="btn btn-outline-secondary btn-sm mt-3" id="changeImgbtn">
                    <i class="fas fa-pen"></i> í”„ë¡œí•„ìˆ˜ì •
                </button>
                <input type="file" id="imageUpload" accept="image/*">
            </div>

            <!-- í”„ë¡œí•„ ì •ë³´ -->
            <div class="col-md-8">
                <div class="row gy-3 text-dark">
                    <div class="col-12">
                        <label class="form-label fw-semibold">ì•„ì´ë””</label>
                        <input type="text" class="form-control" id="userId" th:value="${user.id}" readonly>
                    </div>
                    <div class="col-12">
                        <label class="form-label fw-semibold">ì´ë©”ì¼</label>
                        <input type="email" class="form-control" id="email" th:value="${user.email}" readonly>
                    </div>
                    <div class="col-12">
                        <label class="form-label fw-semibold">ìƒë…„ì›”ì¼</label>
                        <input type="date" class="form-control" id="birthDate" th:value="${user.birthDate}" readonly>
                    </div>
                    <div class="col-12">
                        <label class="form-label fw-semibold">ì´ë¦„</label>
                        <input type="text" class="form-control" id="name" th:value="${user.name}" readonly>
                    </div>
                </div>
                <div class="d-flex justify-content-end gap-2 mt-3">
                    <button class="btn btn-outline-secondary btn-sm" id="profileEditBtn">
                        <i class="fas fa-pen"></i> ìˆ˜ì •
                    </button>
                    <button class="btn btn-success btn-sm d-none" id="profileSaveBtn">ì €ì¥</button>
                    <button class="btn btn-secondary btn-sm d-none" id="profileCancelBtn">ì·¨ì†Œ</button>
                </div>
                <div id="actionButtons" style="margin-top: 20px; display: flex; justify-content: flex-end; gap: 10px;">
                    <button id="deleteAccountBtn"
                            style="background-color: #e74c3c; color: white; border: none; padding: 6px 10px; font-size: 14px; border-radius: 6px; cursor: pointer;">
                        íšŒì› íƒˆí‡´
                    </button>
                </div>
            </div>
        </div>
    </div>
    </div>

    <div class="container my-4 p-0">
        <div class="preference-special-box rounded-3">
            <!-- ì„ íƒëœ ì¥ë¥´ ë°•ìŠ¤ -->
            <div class="mb-3">
                <label class="form-label fw-bold">ì„ í˜¸ ì¥ë¥´</label>
                <div class="p-3 bg-light border rounded" id="selectedGenresBox">ì„ íƒëœ ì¥ë¥´ê°€ ì—†ìŠµë‹ˆë‹¤.</div>
            </div>
        </div>

        <div class="preference-genre-wrapper p-3 rounded-3">
            <!-- ì„ í˜¸ ì¥ë¥´ ì„ íƒ + í†±ë‹ˆë°”í€´ ë²„íŠ¼ -->
            <div class="d-flex align-items-center justify-content-between mb-2">
                <label class="form-label fw-bold mb-0">ì„ í˜¸ ì¥ë¥´ ì„ íƒ</label>
                <div class="d-flex gap-2 align-items-center">
                    <button class="btn btn-outline-secondary btn-sm" id="editBtn" title="ìˆ˜ì •">
                        <i class="fas fa-cog"></i>
                    </button>
                    <button class="btn btn-success btn-sm d-none" id="saveBtn">ì €ì¥</button>
                    <button class="btn btn-secondary btn-sm d-none" id="cancelBtn">ì·¨ì†Œ</button>
                </div>
            </div>

            <!-- ì¥ë¥´ ì„ íƒ ë°•ìŠ¤ -->
            <div class="genre-grid border-top border-bottom py-3 mt-2">
                <!-- ì˜í™” -->
                <div class="genre-column">
                    <h6 class="fw-bold text-center mb-3">ğŸ¬ ì˜í™”</h6>
                    <div id="movieGenres" class="d-flex flex-wrap gap-2 justify-content-center genre-container">
                        <div class="form-check">
                            <input class="form-check-input genre-checkbox" type="checkbox" id="movie-1"
                                   data-type="movie"
                                   data-genre-id="10752"
                                   value="ì „ìŸ" disabled>
                            <label class="form-check-label" for="movie-1">ì „ìŸ</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input genre-checkbox" type="checkbox" id="movie-2"
                                   data-type="movie"
                                   data-genre-id="878"
                                   value="SF" disabled>
                            <label class="form-check-label" for="movie-2">SF</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input genre-checkbox" type="checkbox" id="movie-3"
                                   data-type="movie"
                                   data-genre-id="18"
                                   value="ë“œë¼ë§ˆ" disabled>
                            <label class="form-check-label" for="movie-3">ë“œë¼ë§ˆ</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input genre-checkbox" type="checkbox" id="movie-4"
                                   data-type="movie"
                                   data-genre-id="27"
                                   value="ê³µí¬" disabled>
                            <label class="form-check-label" for="movie-4">ê³µí¬</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input genre-checkbox" type="checkbox" id="movie-5"
                                   data-type="movie"
                                   data-genre-id="35"
                                   value="ì½”ë¯¸ë””" disabled>
                            <label class="form-check-label" for="movie-5">ì½”ë¯¸ë””</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input genre-checkbox" type="checkbox" id="movie-6"
                                   data-type="movie"
                                   data-genre-id="10749"
                                   value="ë¡œë§¨ìŠ¤" disabled>
                            <label class="form-check-label" for="movie-6">ë¡œë§¨ìŠ¤</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input genre-checkbox" type="checkbox" id="movie-7"
                                   data-type="movie"
                                   data-genre-id="16"
                                   value="ì• ë‹ˆë©”ì´ì…˜" disabled>
                            <label class="form-check-label" for="movie-7">ì• ë‹ˆë©”ì´ì…˜</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input genre-checkbox" type="checkbox" id="movie-8"
                                   data-type="movie"
                                   data-genre-id="14"
                                   value="íŒíƒ€ì§€" disabled>
                            <label class="form-check-label" for="movie-8">íŒíƒ€ì§€</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input genre-checkbox" type="checkbox" id="movie-9"
                                   data-type="movie"
                                   data-genre-id="80"
                                   value="ë²”ì£„" disabled>
                            <label class="form-check-label" for="movie-9">ë²”ì£„</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input genre-checkbox" type="checkbox" id="movie-10"
                                   data-type="movie"
                                   data-genre-id="53"
                                   value="ìŠ¤ë¦´ëŸ¬" disabled>
                            <label class="form-check-label" for="movie-10">ìŠ¤ë¦´ëŸ¬</label>
                        </div>
                    </div>
                    <div class="text-center mt-1">
                        <button type="button" id="toggleMovieGenresBtn" class="btn btn-link btn-sm p-0">ë”ë³´ê¸° â–¼
                        </button>
                    </div>
                </div>

                <div class="genre-column">
                    <h6 class="fw-bold text-center mb-3">ğŸ“º TV</h6>
                    <div id="TvGenres" class="d-flex flex-wrap gap-2 justify-content-center genre-container">
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input genre-checkbox" id="tv-1" data-type="tv"
                                   autocomplete="off" data-genre-id="10759"
                                   disabled value="ì•¡ì…˜&ì–´ë“œë²¤ì²˜"/>
                            <label class="form-check-label" for="tv-1">ì•¡ì…˜&ì–´ë“œë²¤ì²˜</label>
                        </div>
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input genre-checkbox" id="tv-2" data-type="tv"
                                   autocomplete="off" data-genre-id="16"
                                   disabled value="ì• ë‹ˆë©”ì´ì…˜"/>
                            <label class="form-check-label" for="tv-2">ì• ë‹ˆë©”ì´ì…˜</label>
                        </div>
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input genre-checkbox" id="tv-3" data-type="tv"
                                   autocomplete="off" data-genre-id="80"
                                   disabled value="ë²”ì£„"/>
                            <label class="form-check-label" for="tv-3">ë²”ì£„</label>
                        </div>
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input genre-checkbox" id="tv-4" data-type="tv"
                                   autocomplete="off" data-genre-id="99"
                                   disabled value="ë‹¤íë©˜í„°ë¦¬"/>
                            <label class="form-check-label" for="tv-4">ë‹¤íë©˜í„°ë¦¬</label>
                        </div>
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input genre-checkbox" id="tv-5" data-type="tv"
                                   autocomplete="off" data-genre-id="18"
                                   disabled value="ë“œë¼ë§ˆ"/>
                            <label class="form-check-label" for="tv-5">ë“œë¼ë§ˆ</label>
                        </div>
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input genre-checkbox" id="tv-6" data-type="tv"
                                   autocomplete="off" data-genre-id="10751"
                                   disabled value="ê°€ì¡±"/>
                            <label class="form-check-label" for="tv-6">ê°€ì¡±</label>
                        </div>

                        <div class="form-check">
                            <input type="checkbox" class="form-check-input genre-checkbox" id="tv-7" data-type="tv"
                                   autocomplete="off" data-genre-id="10762"
                                   disabled value="í‚¤ì¦ˆ/ì–´ë¦°ì´"/>
                            <label class="form-check-label" for="tv-7">í‚¤ì¦ˆ/ì–´ë¦°ì´</label>
                        </div>

                        <div class="form-check">
                            <input type="checkbox" class="form-check-input genre-checkbox" id="tv-8" data-type="tv"
                                   autocomplete="off" data-genre-id="9648"
                                   disabled value="ë¯¸ìŠ¤í…Œë¦¬"/>
                            <label class="form-check-label" for="tv-8">ë¯¸ìŠ¤í…Œë¦¬</label>
                        </div>

                        <div class="form-check">
                            <input type="checkbox" class="form-check-input genre-checkbox" id="tv-9" data-type="tv"
                                   autocomplete="off" data-genre-id="10763"
                                   disabled value="ë‰´ìŠ¤"/>
                            <label class="form-check-label" for="tv-9">ë‰´ìŠ¤</label>
                        </div>

                        <div class="form-check">
                            <input type="checkbox" class="form-check-input genre-checkbox" id="tv-10" data-type="tv"
                                   autocomplete="off" data-genre-id="10764"
                                   disabled value="ë¦¬ì–¼ë¦¬í‹°"/>
                            <label class="form-check-label" for="tv-10">ë¦¬ì–¼ë¦¬í‹°</label>
                        </div>

                        <div class="form-check">
                            <input type="checkbox" class="form-check-input genre-checkbox" id="tv-11" data-type="tv"
                                   autocomplete="off" data-genre-id="10765"
                                   disabled value="SF&íŒíƒ€ì§€"/>
                            <label class="form-check-label" for="tv-11">SF&amp;íŒíƒ€ì§€</label>
                        </div>

                        <div class="form-check">
                            <input type="checkbox" class="form-check-input genre-checkbox" id="tv-12" data-type="tv"
                                   autocomplete="off" data-genre-id="10766"
                                   disabled value="ì—°ì†ê·¹"/>
                            <label class="form-check-label" for="tv-12">ì—°ì†ê·¹</label>
                        </div>

                        <div class="form-check">
                            <input type="checkbox" class="form-check-input genre-checkbox" id="tv-13" data-type="tv"
                                   autocomplete="off" data-genre-id="10767"
                                   disabled value="í† í¬ì‡¼"/>
                            <label class="form-check-label" for="tv-13">í† í¬ì‡¼</label>
                        </div>

                        <div class="form-check">
                            <input type="checkbox" class="form-check-input genre-checkbox" id="tv-14" data-type="tv"
                                   autocomplete="off" data-genre-id="10768"
                                   disabled value="ì „ìŸ&ì •ì¹˜"/>
                            <label class="form-check-label" for="tv-14">ì „ìŸ&amp;ì •ì¹˜</label>
                        </div>

                        <div class="form-check">
                            <input type="checkbox" class="form-check-input genre-checkbox" id="tv-15" data-type="tv"
                                   autocomplete="off" data-genre-id="37"
                                   disabled value="ì„œë¶€ê·¹"/>
                            <label class="form-check-label" for="tv-15">ì„œë¶€ê·¹</label>
                        </div>
                    </div>
                    <div class="text-center mt-1">
                        <button type="button" id="toggleTvGenresBtn" class="btn btn-link btn-sm p-0">ë”ë³´ê¸° â–¼
                        </button>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <section id="selform">
        <div class="preference-wow-box">
            <div class="d-flex justify-content-between" style="padding-left: 11px; padding-right: 11px;">
                <div class="bookmark">ë¶ë§ˆí¬</div>
                <div class="bookmark"><i class="fa-regular fa-bookmark"></i></div>
            </div>
            <div class="swiper mySwiper1 mt-2" style="border-top: 2px solid #102B70; border-bottom: 2px solid #102B70;">
                <div class="swiper-wrapper">
                    <div class="swiper-slide" th:if="${#lists.size(favoriteSlider)} > 0"
                         th:each="item: ${favoriteSlider}" th:data-contents-id="${item.id}"
                         th:data-contents-type="${item.type}" style="height: 337px;">
                        <a th:href="|/${item.type}/${item.id}|" style="display: inline-block;">
                            <img src="#" th:alt="${item.originalTitle}"
                                 th:src="${item.posterPath != null} ? 'https://image.tmdb.org/t/p/w500/' + ${item.posterPath} : '/images/no-image.png'"/>
                        </a>
                        <div class="delform">
                            <div class="my-movie-title limit-text" th:text="${item.title}">ë²”ì£„ë„ì‹œ</div>
                        </div>
                        <div class="d-flex align-items-center justify-content-around">
                            <div class="my-movie-date" th:text="${item.releaseDate}">20xx.xx.xx</div>
                            <div class="star-rating"
                                 th:attr="data-current-rating=${item.voteAverage}, data-vote-count=${item.voteCount}">
                                <span class="star" data-index="1">â˜…</span>
                                <span class="star" data-index="2">â˜…</span>
                                <span class="star" data-index="3">â˜…</span>
                                <span class="star" data-index="4">â˜…</span>
                                <span class="star" data-index="5">â˜…</span>
                            </div>
                            <button type="button" class="delete-button"><i class="fa-solid fa-trash"></i>ï¸</button>
                        </div>
                    </div>
                </div>
                <div class="swiper-scrollbar"></div>
            </div>
        </div>
    </section>

</main>
<div id="imageSelectModal" class="modal" style="display: none;">
    <div class="modal-content">
        <h5>í”„ë¡œí•„ ì´ë¯¸ì§€ ì„ íƒ</h5>
        <div class="image-list">
            <img src="/images/profile_female1.png" class="avatar" data-src="/images/profile_female1.png">
            <img src="/images/profile_female2.png" class="avatar" data-src="/images/profile_female2.png">
            <img src="/images/profile_female3.png" class="avatar" data-src="/images/profile_female3.png">
            <img src="/images/profile_male1.png" class="avatar" data-src="/images/profile_male1.png">
            <img src="/images/profile_male2.png" class="avatar" data-src="/images/profile_male2.png">
            <img src="/images/profile_male3.png" class="avatar" data-src="/images/profile_male3.png">
        </div>
        <button class="btn btn-primary mt-3" id="selectDoneBtn">ì„ íƒ ì™„ë£Œ</button>
    </div>
</div>
<footer th:replace="~{/layout/footer :: footer}"></footer>
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<script src="js/swiper.js"></script>
<script th:inline="javascript">
    $(function () {
        function setUserGenres() {
            const preferGenreMovieList = /*[[${preferGenreMovieList}]]*/ [];
            const preferGenreTvList = /*[[${preferGenreTvList}]]*/ [];
            const movieGenres = $("#movieGenres input");
            const tvGenres = $("#TvGenres input");

            for (let i = 0; i < preferGenreMovieList.length; i++) {
                for (let j = 0; j < movieGenres.length; j++) {
                    if (preferGenreMovieList[i] == $(movieGenres[j]).data("genre-id")) {
                        $(movieGenres[j]).prop('checked', true);
                    }
                }
            }
            for (let i = 0; i < preferGenreTvList.length; i++) {
                for (let j = 0; j < tvGenres.length; j++) {
                    if (preferGenreTvList[i] == $(tvGenres[j]).data("genre-id")) {
                        $(tvGenres[j]).prop('checked', true);
                    }
                }
            }
            updateSelectedGenres();
        }

        $('#profileEditBtn').on('click', function () {
            $('#email, #birthDate, #name').removeAttr('readonly').first().focus();
            $('#profileEditBtn').addClass('d-none');
            $('#profileSaveBtn, #profileCancelBtn').removeClass('d-none');
        });

        // í”„ë¡œí•„ ì €ì¥ ë²„íŠ¼ í´ë¦­
        $('#profileSaveBtn').on('click', function () {
            // ì—¬ê¸°ì„œ ajaxë¡œ ì„œë²„ ì €ì¥ ì²˜ë¦¬ ê°€ëŠ¥
            $('input').attr('readonly', true);
            $('#profileEditBtn').removeClass('d-none');
            $('#profileSaveBtn, #profileCancelBtn').addClass('d-none');
        });

        // í”„ë¡œí•„ ì·¨ì†Œ ë²„íŠ¼ í´ë¦­
        $('#profileCancelBtn').on('click', function () {
            // ì·¨ì†Œ ì‹œ ê¸°ì¡´ ê°’ìœ¼ë¡œ ë˜ëŒë¦¬ê¸° (í•„ìš” ì‹œ ajax í˜¸ì¶œí•´ì„œ ìµœì‹ ê°’ ì¬ì„¤ì •)
            // ì—¬ê¸°ì„œëŠ” ì„ì‹œë¡œ ê·¸ëƒ¥ readonly ì²˜ë¦¬ ë° ë²„íŠ¼ ì›ë³µë§Œ
            $('input').attr('readonly', true);
            $('#profileEditBtn').removeClass('d-none');
            $('#profileSaveBtn, #profileCancelBtn').addClass('d-none');
        });
        $(function () {
            let originalValues = {};

            $('#profileEditBtn').on('click', function () {
                // originalValues.userId = $('#userId').val();
                originalValues.email = $('#email').val();
                originalValues.birthDate = $('#birthDate').val();
                originalValues.name = $('#name').val();

                $('#email, #birthDate, #name').removeAttr('readonly').first().focus();

                $('#profileEditBtn').addClass('d-none');
                $('#profileSaveBtn, #profileCancelBtn').removeClass('d-none');
            });

            $('#profileCancelBtn').on('click', function () {
                // $('#userId').val(originalValues.userId);
                $('#email').val(originalValues.email);
                $('#birthDate').val(originalValues.birthDate);
                $('#name').val(originalValues.name);

                $('#email, #birthDate, #name').attr('readonly', true);

                $('#profileEditBtn').removeClass('d-none');
                $('#profileSaveBtn, #profileCancelBtn').addClass('d-none');
            });

            $('#profileSaveBtn').on('click', function () {
                // ajax ì €ì¥ ì²˜ë¦¬ ë“± í•„ìš”í•œ ì‘ì—… ìˆ˜í–‰ í›„

                $('#userId, #email, #birthDate, #name').attr('readonly', true);

                $('#profileEditBtn').removeClass('d-none');
                $('#profileSaveBtn, #profileCancelBtn').addClass('d-none');
            });
        });

        document.getElementById('deleteAccountBtn').addEventListener('click', function () {
            const confirmed = confirm('ì •ë§ë¡œ íšŒì› íƒˆí‡´í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');

            if (confirmed) {
                $.ajax({
                    url: "/auth/deleteUser",
                    type: "DELETE",
                    success: function () {
                        alert('íšŒì›ì´ ì„±ê³µì ìœ¼ë¡œ íƒˆí‡´ë˜ì—ˆìŠµë‹ˆë‹¤.');
                        location.href="/auth/logoutProcess"
                    }
                })
            } else {
                // ì‚¬ìš©ìê°€ ì·¨ì†Œ ëˆŒë €ì„ ë•Œ
                alert('íƒˆí‡´ê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        });

// ì¥ë¥´ ì„ íƒ ìˆ˜ì • ë²„íŠ¼ í´ë¦­
        $('#editBtn').on('click', function () {
            $('.genre-checkbox').prop('disabled', false);
            $('#editBtn').addClass('d-none');
            $('#saveBtn, #cancelBtn').removeClass('d-none');

            // ìˆ˜ì • ë²„íŠ¼ í´ë¦­ì‹œ ì»¨í…Œì´ë„ˆ í¼ì¹˜ê¸°
            $('#movieGenres').addClass('expanded');
            $('#toggleMovieGenresBtn').html('ì ‘ê¸° â–²');
            $('#TvGenres').addClass('expanded');
            $('#toggleTvGenresBtn').html('ì ‘ê¸° â–²');


        });

        // ì¥ë¥´ ì„ íƒ ì €ì¥ ë²„íŠ¼ í´ë¦­
        $('#saveBtn').on('click', function () {
            $('.genre-checkbox').prop('disabled', true);
            updateSelectedGenres();
            $('#editBtn').removeClass('d-none');
            $('#saveBtn, #cancelBtn').addClass('d-none');

            // ì €ì¥ì‹œ ì»¨í…Œì´ë„ˆ ì´ˆê¸°í™”
            $('#movieGenres').removeClass('expanded');
            $('#toggleMovieGenresBtn').html('ë”ë³´ê¸° â–¼');

            $('#TvGenres').removeClass('expanded');
            $('#toggleTvGenresBtn').html('ë”ë³´ê¸° â–¼');
        });

        // ì €ì¥ëœ ì„ í˜¸ ì¥ë¥´ ë°ì´í„° ì˜ˆì‹œ (ì„œë²„ì—ì„œ ë°›ì•„ì˜¨ ë°ì´í„°ë¡œ ëŒ€ì²´í•˜ì„¸ìš”)
        const savedGenres = [];

// ì €ì¥ëœ ì¥ë¥´ ì²´í¬ë°•ìŠ¤ ìƒíƒœ ë³µì› í•¨ìˆ˜
        function restoreSavedGenres() {
            // ëª¨ë“  ì²´í¬ë°•ìŠ¤ ì´ˆê¸°í™”
            $('.genre-checkbox').prop('checked', false);

            // ì €ì¥ëœ ì¥ë¥´ì— í•´ë‹¹í•˜ëŠ” ì²´í¬ë°•ìŠ¤ë§Œ ì²´í¬ ì²˜ë¦¬
            savedGenres.forEach(item => {
                $(`.genre-checkbox[data-type="${item.type}"][value="${item.genre}"]`).prop('checked', true);
            });

            // ì²´í¬ë°•ìŠ¤ ë¹„í™œì„±í™” ì²˜ë¦¬
            $('.genre-checkbox').prop('disabled', true);

            // ì„ íƒëœ ì¥ë¥´ ë°•ìŠ¤ ì—…ë°ì´íŠ¸
            updateSelectedGenres();
        }

// ìˆ˜ì • ë²„íŠ¼ í´ë¦­
        $('#editBtn').on('click', function () {
            $('.genre-checkbox').prop('disabled', false);
            $('#editBtn').addClass('d-none');
            $('#saveBtn, #cancelBtn').removeClass('d-none');

            // ì»¨í…Œì´ë„ˆ í¼ì¹˜ê¸°
            $('#movieGenres').addClass('expanded');
            $('#toggleMovieGenresBtn').html('ì ‘ê¸° â–²');
            $('#TvGenres').addClass('expanded');
            $('#toggleTvGenresBtn').html('ì ‘ê¸° â–²');
        });

// ì €ì¥ ë²„íŠ¼ í´ë¦­
        $('#saveBtn').on('click', function () {
            $('.genre-checkbox').prop('disabled', true);

            // ì €ì¥ëœ ìƒíƒœ ê°±ì‹  (ì‹¤ì œ ì„œë²„ì™€ ì—°ë™ ì‹œ ì—¬ê¸°ì„œ ë°ì´í„° ì „ì†¡)
            // ì˜ˆì‹œë¡œ savedGenres ë°°ì—´ ì—…ë°ì´íŠ¸
            savedGenres.length = 0; // ì´ˆê¸°í™”
            $('.genre-checkbox:checked').each(function () {
                savedGenres.push({
                    type: $(this).data('type'),
                    genre: $(this).val()
                });
            });

            updateSelectedGenres();
            updatePreferGenres();

            $('#editBtn').removeClass('d-none');
            $('#saveBtn, #cancelBtn').addClass('d-none');

            // ì»¨í…Œì´ë„ˆ ì ‘ê¸°
            $('#movieGenres').removeClass('expanded');
            $('#toggleMovieGenresBtn').html('ë”ë³´ê¸° â–¼');
            $('#TvGenres').removeClass('expanded');
            $('#toggleTvGenresBtn').html('ë”ë³´ê¸° â–¼');
        });

// ì·¨ì†Œ ë²„íŠ¼ í´ë¦­
        $('#cancelBtn').on('click', function () {
            // ì €ì¥ëœ ìƒíƒœë¡œ ë³µì›
            restoreSavedGenres();

            $('#editBtn').removeClass('d-none');
            $('#saveBtn, #cancelBtn').addClass('d-none');

            // ì»¨í…Œì´ë„ˆ ì ‘ê¸°
            $('#movieGenres').removeClass('expanded');
            $('#toggleMovieGenresBtn').html('ë”ë³´ê¸° â–¼');
            $('#TvGenres').removeClass('expanded');
            $('#toggleTvGenresBtn').html('ë”ë³´ê¸° â–¼');
            setUserGenres();
        });

// ì²´í¬ë°•ìŠ¤ ë³€ê²½ì‹œ ì„ íƒëœ ì¥ë¥´ ì—…ë°ì´íŠ¸ (í¸ì§‘ ì¤‘ì¼ ë•Œë§Œ)
        $('.genre-checkbox').on('change', function () {
            if (!$('#saveBtn').hasClass('d-none')) {
                updateSelectedGenres();
            }
        });

// ì˜í™” ì¥ë¥´ ë”ë³´ê¸° ë²„íŠ¼ í´ë¦­
        $('#toggleMovieGenresBtn').on('click', function () {
            const container = $('#movieGenres');
            if (container.hasClass('expanded')) {
                container.removeClass('expanded');
                $(this).html('ë”ë³´ê¸° â–¼');
            } else {
                container.addClass('expanded');
                $(this).html('ì ‘ê¸° â–²');
            }
        });

// TV ì¥ë¥´ ë”ë³´ê¸° ë²„íŠ¼ í´ë¦­
        $('#toggleTvGenresBtn').on('click', function () {
            const container = $('#TvGenres');
            if (container.hasClass('expanded')) {
                container.removeClass('expanded');
                $(this).html('ë”ë³´ê¸° â–¼');
            } else {
                container.addClass('expanded');
                $(this).html('ì ‘ê¸° â–²');
            }
        });

// ì„ íƒëœ ì¥ë¥´ ë°•ìŠ¤ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateSelectedGenres() {
            const selected = [];
            $('.genre-checkbox:checked').each(function () {
                // TV : ì´ëª¨ì§€ì™€ ì¥ë¥´ëª… ê°•ì¡°
                const typeEmoji = $(this).data('type') === 'movie' ? 'ğŸ¬' : 'ğŸ“º';
                selected.push(`<span>${typeEmoji} <strong>${$(this).val()}</strong></span>`);
            });

            if (selected.length > 0) {
                // ì•„ì´í…œ ì‚¬ì´ì— êµ¬ë¶„ì ìœ¼ë¡œ ' Â· ' ë„£ê¸°
                $('#selectedGenresBox').html(selected.join(' <span style="color:#999;">Â·</span> '));
            } else {
                $('#selectedGenresBox').text('ì„ íƒëœ ì¥ë¥´ê°€ ì—†ìŠµë‹ˆë‹¤.');
            }
        }

// ì´ˆê¸° ë¡œë”© ì‹œ ì €ì¥ëœ ì¥ë¥´ ë³µì›
        $(document).ready(function () {
            // restoreSavedGenres();
            setUserGenres();
        });

        function updateSelectedGenres() {
            const selected = [];
            $('.genre-checkbox:checked').each(function () {
                const type = $(this).data('type');  // ì˜í™” or TV
                const genre = $(this).val();
                let emoji = '';
                if (type === 'movie') {
                    emoji = 'ğŸ¬';
                } else if (type === 'tv') {
                    emoji = 'ğŸ“º';
                }
                selected.push(
                    `<span style="font-weight:700; font-size:1.1em;">${emoji}</span>` +
                    `<span style="font-weight:400; font-size:0.9em; color:#666;"> ${genre}</span>`
                );
            });
            if (selected.length > 0) {
                // ì‰¼í‘œ ëŒ€ì‹  ' Â· ' ë„£ê³  ê° ì•„ì´í…œì— ì¢Œìš° ì—¬ë°± ì•½ê°„ ì¤Œ
                $('#selectedGenresBox').html(
                    selected.map(item => `<span style="margin: 0 6px;">${item}</span>`).join('Â·')
                );
            } else {
                $('#selectedGenresBox').text('ì„ íƒëœ ì¥ë¥´ê°€ ì—†ìŠµë‹ˆë‹¤.');
            }
        }


        // // ë¶ë§ˆí¬ ë‚´ìš© ì‚­ì œ ë²„íŠ¼
        // $('.delete-button').on('click', function () {
        //     $(this).closest('.swiper-slide').remove();
        //     swiper1.update();
        //
        //     // ìŠ¤í¬ë¡¤ë°” ì—…ë°ì´íŠ¸
        //     hideScrollbarIfNeeded(swiper1);
        // });

    });

    // ë¶ë§ˆí¬ ì‚¬ìš©ì ìµœëŒ€ ê°¯ìˆ˜ í‘œì‹œ
    const swiper1 = new Swiper(".mySwiper1", {
        slidesPerView: 3,
        spaceBetween: 10,
        freeMode: true,
        mousewheel: true,
        watchOverflow: true,
        scrollbar: {
            el: ".mySwiper1 .swiper-scrollbar",
            hide: false,
            draggable: true,
        },
        on: {
            init: function () {
                hideScrollbarIfNeeded(this);
            },
            resize: function () {
                hideScrollbarIfNeeded(this);
            },
        }
    });

    // ë¶ë§ˆí¬ ë‚´ìš©ë¬¼ ì—…ë°ì´íŠ¸ í›„ ìŠ¤í¬ë¡¤ ë³€í™” (3ê°œ ì´í•˜ë©´ ìŠ¤í¬ë¡¤ ì•ˆë¨)
    function hideScrollbarIfNeeded(swiper) {
        const scrollbar = document.querySelector(".mySwiper1 .swiper-scrollbar");
        const wrapper = swiper.wrapperEl;
        const wrapperWidth = wrapper.scrollWidth;
        const containerWidth = swiper.el.clientWidth;

        if (wrapperWidth <= containerWidth) {
            scrollbar.style.display = "none";
        } else {
            scrollbar.style.display = "block";
        }
    }

    let selectedImage = '';

    // ëª¨ë‹¬ ì—´ê¸°
    document.getElementById('changeImgbtn').addEventListener('click', function () {
        document.getElementById('imageSelectModal').style.display = 'flex';
    });

    // ì´ë¯¸ì§€ ì„ íƒ
    document.querySelectorAll('.avatar').forEach(img => {
        img.addEventListener('click', function () {
            selectedImage = this.getAttribute('data-src');
            document.querySelectorAll('.avatar').forEach(i => i.classList.remove('selected'));
            this.classList.add('selected');
        });
    });

    // ì„ íƒ ì™„ë£Œ ë²„íŠ¼
    document.getElementById('selectDoneBtn').addEventListener('click', function () {
        if (selectedImage) {
            document.getElementById('fileImg').src = selectedImage;
        }
        document.getElementById('imageSelectModal').style.display = 'none';


        // ì„œë²„ì— ì„ íƒí•œ ì´ë¯¸ì§€ ì €ì¥ (ajax + PUT)
        $.ajax({
            url: 'imgUpdate',   // ì„œë²„ì—ì„œ ë°›ëŠ” URLë¡œ ë°”ê¿”ì£¼ì„¸ìš”
            type: 'PUT',
            contentType: 'application/json',
            data: JSON.stringify({profileImg: selectedImage}),
            success: function (res) {
                alert('í”„ë¡œí•„ ì´ë¯¸ì§€ê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.');

                $('#headerProfileImg').attr('src', selectedImage);
            },
            error: function (err) {
                console.error('ì €ì¥ ì‹¤íŒ¨:', err);
                alert('ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        });
    });

    function updatePreferGenres() {
        const genreMap = {};

        // ì²´í¬ëœ ì²´í¬ë°•ìŠ¤ë¥¼ ìˆœíšŒí•˜ë©° ì¥ë¥´ ë¶„ë¥˜
        $('.genre-checkbox:checked').each(function () {
            const genreId = $(this).data('genre-id');
            const genreType = $(this).data('type');

            if (!genreMap[genreType]) {
                genreMap[genreType] = [];
            }
            genreMap[genreType].push(genreId);
        });

        // genreMapì„ ë°°ì—´ í˜•íƒœë¡œ ë³€í™˜
        const data = Object.entries(genreMap).map(([type, genreIds]) => ({
            type,
            genreIds
        }));

        if (data.length === 0) {
            alert("ì„ í˜¸ ì¥ë¥´ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");
            return;
        }

        $.ajax({
            type: 'POST',
            url: '/profile/genres',
            contentType: 'application/json',
            data: JSON.stringify(data),
            success: function (response) {
                alert('ì„ í˜¸ ì¥ë¥´ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
                // ì €ì¥ í›„ ë²„íŠ¼ ìƒíƒœ ì „í™˜ ë“± ì²˜ë¦¬
                $('#editBtn').removeClass('d-none');
                $('#saveBtn, #cancelBtn').addClass('d-none');
                $('.genre-checkbox').prop('disabled', true);
            },
            error: function () {
                alert('ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        });
    }
</script>
<script>
    $(document).ready(function () {
        $(".delete-button").on("click", function () {
            const $slide = $(this).closest('.swiper-slide');
            const contentId = $slide.data('contents-id');
            const contentsType = $slide.data('contents-type');

            if (confirm(`ì„ íƒ í•­ëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                // ì„œë²„ì— ì‚­ì œ ìš”ì²­
                $.ajax({
                    url: '/bookmark',
                    type: 'DELETE',
                    data: {type: contentsType, contentId: contentId},
                    success: () => {
                        $slide.remove();
                    },
                    error: () => alert('ë¶ë§ˆí¬ ì·¨ì†Œ ì‹¤íŒ¨')
                });
            }
        });
    });
</script>

<!-- ìˆ˜ì •ëœ íšŒì›ì •ë³´ ë°ì´í„° ajax -->
<script>
    $('#profileSaveBtn').on('click', function () {
        const data = {
            userId: $('#userId').val(),
            email: $('#email').val(),
            birthDate: $('#birthDate').val(),
            name: $('#name').val()
        };


        $.ajax({
            url: '/userUpdate',   // â† ì—¬ê¸°ì— ì‹¤ì œ URL
            type: 'PUT',                 // ë˜ëŠ” POSTë„ ê°€ëŠ¥
            contentType: 'application/json',
            data: JSON.stringify(data),
            success: function (res) {
                alert('íšŒì›ì •ë³´ ìˆ˜ì • ë˜ì—ˆìŠµë‹ˆë‹¤');
                location.reload(); // ìƒˆë¡œê³ ì¹¨ í• ì§€ ë§ì§€ëŠ” ìƒí™©ì— ë”°ë¼
            },
            error: function (xhr, status, error) {
                console.error('ì—ëŸ¬ ë°œìƒ:', status, error);
                alert('íšŒì›ì •ë³´ ìˆ˜ì • ì‹¤íŒ¨');
            }
        });
    });
</script>
<script src="/js/star2.js" defer></script>
</body>
</html>