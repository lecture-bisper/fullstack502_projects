<!DOCTYPE html>
<html lang="ko" xmlns:th="http:www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width , initial-scale=1.0">
    <title>Title</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q"
            crossorigin="anonymous"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
    <link rel="stylesheet" href="/css/login.css">
</head>
<body>
<header th:replace="~{/layout/header :: headerNavbar}"></header>
<form id="loginFrm">
    <table class="rounded-4 pt-4 pb-4 ps-3 pe-3">
        <tr>
            <td><h2 class="mb-3">로그인</h2></td>
        </tr>
        <tr>
            <td class="p-0">  <!-- padding은 0으로 빼고 내부에서 처리 -->
                <div class="id_border p-3">
                    <p class="user">아이디</p>
                    <input class="my-2" type="text" id="user" name="userId" placeholder="아이디를 입력하세요"/>
                    <p class="errorid">아이디를 입력해주세요</p>
                </div>
                <div class="pw_border p-3">
                    <p class="pass">비밀번호</p>
                    <input class="mt-2 mb-0" type="password" id="pass" name="userPw" placeholder="비밀번호를 입력하세요"/>
                    <p class="errorpw">비밀번호를 입력해주세요</p>
                </div>
            </td>
        </tr>
        <tr>
            <td class="links mx-3">
                <div>
                    <a href="/auth/lostid" class="d-block">아이디 찾기</a>

                    <a href="/auth/lostpw" class="d-block">비밀번호 찾기</a>
                </div>
                <a href="/auth/join">회원가입</a>
            </td>

        <tr>
            <td class="text-center">
                <input type="submit" value="로그인" class="btn btn-lg mt-5" id="loginbtn">
            </td>
        </tr>

    </table>
</form>

<script>
    $("#loginbtn").click(function (e) {
        e.preventDefault();
        let userid = document.querySelector("#user").value;
        let userpw = document.querySelector("#pass").value;

        if (userid.length === 0) {
            $("p.errorid").css('display', 'block');
        } else {
            $("p.errorid").css('display', 'none');
        }
        if (userpw.length === 0) {
            $("p.errorpw").css('display', 'block');
        } else {
            $("p.errorpw").css('display', 'none');
        }
        // 로그인 요청
        $.post("/auth/loginProcess", {userId: userid, userPw: userpw}, function (res) {
            if (res === "success") {
                location.href = "/main"; // 로그인 성공 시 메인으로 이동
            } else {
                alert("아이디 또는 비밀번호가 일치하지 않습니다.");
            }
        });
    });
</script>

<footer th:replace="~{/layout/footer :: footer}"></footer>
</body>
<link rel="stylesheet" href="/css/header.css">
</html>