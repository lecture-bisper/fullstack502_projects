<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q"
            crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <link th:href="@{/css/style.css}" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap"
          rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/pretendard.css">


    <style>

        .photo:hover img {
            transform: scale(1.3);
            transition: transform 0.5s ease;
        }

        .photo img {
            transition: transform 0.5s ease;
        }

        .gallery-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 40px auto;
            max-width: 1000px;
            height: auto;
        }

        .photo {
            position: absolute;
            top: 0;
            transition: all 0.6s ease-in-out;
            opacity: 0.6;
            transform: scale(0.85);
            cursor: pointer;
        }

        .photo.center {
            z-index: 3;
            transform: translateX(-50%) scale(1);
            opacity: 1;
            left: 50%;
        }

        .photo.left {
            left: 0;
            z-index: 2;
        }

        .photo.right {
            right: 0;
            z-index: 2;
        }

        .photo .card {
            width: 90vw;
            max-width: 300px;
            height: auto;
            transition: transform 0.6s ease;
        }

        .photo.center .card {
            transform: scale(1.05);
        }

        .photo.left .card,
        .photo.right .card {
            transform: scale(0.9);
        }

        @media (min-width: 768px) {
            .photo .card {
                max-width: 280px;
            }
        }

        @media (min-width: 992px) {
            .photo .card {
                max-width: 300px;
            }
        }
    </style>


</head>

<body class="pretendard">

<div th:replace="layout/header :: header"></div>

<!--메인화면 슬라이드 들어갈 자리-->
<div style="width: 100%; height: 700px; margin-top: 30px;">
    <div id="carouselExampleIndicators" class="carousel slide">
        <div class="carousel-indicators">
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active"
                    aria-current="true" aria-label="Slide 1"></button>
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1"
                    aria-label="Slide 2"></button>
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2"
                    aria-label="Slide 3"></button>
        </div>
        <div class="carousel-inner" style="opacity: 70%;">
            <div class="carousel-item active" style="width: 100%; height: 700px;">
                <img src="/img/brand/diesel-poster.jpg" class="d-block mx-auto" alt="..."
                     style="width: 75%; height: 700px; object-fit: cover;">
            </div>
            <div class="carousel-item" style="width: 100%; height: 700px;">
                <img src="/img/brand/sculptor-poster.jpg" class="d-block mx-auto" alt="..."
                     style="width: 75%; height: 700px; object-fit: cover;">
            </div>
            <div class="carousel-item" style="width: 100%; height: 700px;">
                <img src="/img/brand/tecket-poster2.jpg" class="d-block mx-auto" alt="..."
                     style="width: 75%; height: 700px; object-fit: cover;">
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators"
                data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators"
                data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>
</div>
<div class="d-flex flex-column" style="gap: 150px;">
    <div class="container text-center" style="margin-top: 150px; margin-bottom: 50px;">
        <div class="gallery-container position-relative">
            <a class="photo left" data-index="0" href="#" target="_blank"></a>
            <a class="photo center" data-index="1" href="#" target="_blank"></a>
            <a class="photo right" data-index="2" href="#" target="_blank"></a>
        </div>
    </div>
    <div class="d-inline-block text-center" style="margin-bottom: 100px; margin-top: 100px;">
        <a th:href="@{/boardList}" class="btn btn-outline-light">LOOKBOOK →</a>
    </div>
</div>
<script>
    let cardData = [];

    function createCardHTML(data) {
        return `
        <div class="card shadow-sm" style="padding: 5px;">
          <img src="${data.boardUploadPhoto}" class="card-img-top" alt="..." style="height: 180px; padding: 10px; background-color: #000000; object-fit: cover;">
          <div class="card-body">
            <p class="card-text text-truncate">${data.boardPost}</p>
          </div>
        </div>
      `;
    }


    function updateCards(order) {
        const classes = ['left', 'center', 'right'];

        $('.photo').each((i, el) => {
            const $el = $(el);
            const dataIdx = order[i];
            const item = cardData[dataIdx];

            // 내용 업데이트
            $el.html(createCardHTML(item));
            $el.attr('href', item.linkUrl);
            $el.attr('data-index', dataIdx);

            // 클래스 업데이트
            $el.removeClass('left center right').addClass(classes[i]);
        });
    }


    let currentOrder = [0, 1, 2]; // 좌, 중, 우 순서

    function rotate(direction) {
        if (direction === 'right') {
            currentOrder.push(currentOrder.shift()); // 왼쪽을 맨 뒤로
        } else {
            currentOrder.unshift(currentOrder.pop()); // 오른쪽을 맨 앞으로
        }
        updateCards(currentOrder);
    }


    $(document).on('click', '.left', function (e) {
        e.preventDefault();
        rotate('left');
    });

    $(document).on('click', '.right', function (e) {
        e.preventDefault();
        rotate('right');
    });

    $(document).ready(function () {
        $.ajax({
            url: '/api/boards/recent',  // 백엔드와 URL 맞춤
            type: 'GET',
            dataType: 'json',
            success: function (data) {
                if (data.length < 3) {
                    alert("최소 3개의 게시글이 필요합니다.");
                    return;
                }
                data.forEach(d => {
                    d.linkUrl = `/boardDetail/${d.boardIdx}`;
                });
                cardData = data;
                updateCards([0, 1, 2]);
            },
            error: function (err) {
                console.error("데이터 불러오기 실패:", err);
            }
        });
    });
</script>


<div th:replace="layout/footer :: footer"></div>

</body>

</html>